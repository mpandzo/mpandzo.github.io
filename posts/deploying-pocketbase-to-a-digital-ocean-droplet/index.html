<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deploying PocketBase to a Digital Ocean droplet</title>
    <meta name="description" content="The steps to follow to deploy PocketBase to a Digital Ocean droplet">
    <meta name="generator" content="Eleventy v1.0.1">

    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prism-base16-monokai.dark.css">
    <link rel="stylesheet" href="/css/prism-diff.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Mirza Pandzo">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="Mirza Pandzo">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NZ0KLGD1CV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NZ0KLGD1CV');
    </script>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="home"><a href="/">Mirza Pandzo</a></div>
        <ul class="nav">
          <li class="nav-item"><a href="/posts/">Posts</a></li>
          <li class="nav-item"><a href="/tags/">Tags</a></li>
        </ul>
      </div>
    </header>

    <main class="tmpl-post container">
      <h1>Deploying PocketBase to a Digital Ocean droplet</h1>

<div class="meta">
  <div class="published">
    Published on
    <time datetime="2022-08-11">11 Aug 2022</time>
  </div>
  <span class="separator">-</span>
  <div class="tags"><a href="/tags/pocketbase/" class="post-tag">PocketBase</a><a href="/tags/digital-ocean/" class="post-tag">Digital Ocean</a>
  </div>
</div>

<p>PocketBase is a beautiful single-file backend featuring a realtime database (SQLite), built-in user management, nice dashboard UI, configurable S3 storage and a simple REST API.</p>
<p>To deploy PocketBase to Digital Ocean you have to create a new droplet first <a href="#link-1">[1]</a>. When you complete the form to create your server use the Ubuntu distribution and make sure you specify your SSH keys for ssh access <a href="#link-2">[2]</a>. When the create process completes, note down the droplet's assigned IP address as you will use it later.</p>
<p>Once the droplet is created, create an A record mapping the aforementioned assigned IP address to your domain name. You can do this at your domain name registrar if your DNS is managed there. Alternatively, you can point your domain name's nameservers to Digital Ocean and manage your DNS - and create your A record - there <a href="#link-3">[3]</a>.</p>
<p>Once your droplet is ready to go, ssh to it as the root user <code>ssh root@youripaddress</code>. Replace youripaddress with the IP address assigned to your droplet.</p>
<p>Once connected, run apt update and apt upgrade to make sure your server is up to date.</p>
<pre class="language-markup"><code class="language-markup">apt update<br>apt upgrade</code></pre>
<p>While at it, install unzip as you'll need it to unzip the PocketBase archive.</p>
<pre class="language-markup"><code class="language-markup">apt install unzip</code></pre>
<p>Configure the firewall to allow connections to ports 80 &amp; 443. Don't forget port 22 tcp access as you'll no longer be able to ssh to your droplet otherwise.</p>
<pre class="language-markup"><code class="language-markup">sudo ufw allow 22/tcp<br>sudo ufw allow 80<br>sudo ufw allow 443</code></pre>
<p>Enable the ufw firewall.</p>
<pre class="language-markup"><code class="language-markup">sudo ufw enable</code></pre>
<p>You should see the following prompt and message:</p>
<pre class="language-markup"><code class="language-markup">Command may disrupt existing ssh connections. Proceed with operation (y|n)? y<br>Firewall is active and enabled on system startup</code></pre>
<p>Now check that firewall is enabled and that the aforementioned ports are open:</p>
<pre class="language-markup"><code class="language-markup">ufw status</code></pre>
<p>You should see the following:</p>
<pre class="language-markup"><code class="language-markup">Status: active<br><br>To                         Action      From<br>--                         ------      ----<br>80                         ALLOW       Anywhere<br>443                        ALLOW       Anywhere<br>22/tcp                     ALLOW       Anywhere<br>80 (v6)                    ALLOW       Anywhere (v6)<br>443 (v6)                   ALLOW       Anywhere (v6)<br>22/tcp (v6)                ALLOW       Anywhere (v6)</code></pre>
<p>Now that the basics are configured, you can cd into the /opt folder and install PocketBase <a href="#link-4">[4]</a>. Please note the latest version of PocketBase is 0.7.10 at the time of writing. The example below targets the Linux amd64 OS and architecture.</p>
<pre class="language-markup"><code class="language-markup">cd /opt<br>wget https://github.com/pocketbase/pocketbase/releases/download/v0.7.10/pocketbase_0.7.10_linux_amd64.zip<br>mkdir pocketbase_0.7.10_linux_amd64<br>mv pocketbase_0.7.10_linux_amd64.zip pocketbase_0.7.10_linux_amd64<br>cd pocketbase_0.7.10_linux_amd64<br>unzip pocketbase_0.7.10_linux_amd64.zip<br>chmod +x pocketbase</code></pre>
<p>You will note that I made a pocketbase_0.7.10_linux_amd64 directory where I stored all related files. This is done so that once an upgrade of PocketBase is released, I can unzip it in a different folder in /opt and run PocketBase from there instead.</p>
<p>You can now run your server with the following command:</p>
<pre class="language-markup"><code class="language-markup">./pocketbase serve --http="yourdomain.com:80" --https="yourdomain.com:443"</code></pre>
<p>However, you may wish to allow your application to start on its own or restart in case the process get killed. To do this, create a Systemd service.</p>
<p>The following lines will create an empty pocketbase.service file in /lib/systemd/system and then open it in Nano.</p>
<pre class="language-markup"><code class="language-markup">touch /lib/systemd/system/pocketbase.service<br>nano /lib/systemd/system/pocketbase.service</code></pre>
<p>Now, paste the following code and ctrl-X to exist and save. Make sure to change relevant information like <a href="http://yourdomain.com">yourdomain.com</a> and the installation directory if different.</p>
<pre class="language-markup"><code class="language-markup">[Unit]<br>Description = pocketbase<br><br>[Service]<br>Type           = simple<br>User           = root<br>Group          = root<br>LimitNOFILE    = 4096<br>Restart        = always<br>RestartSec     = 5s<br>StandardOutput = append:/opt/pocketbase_0.7.10_linux_amd64/logs/access.log<br>StandardError  = append:/opt/pocketbase_0.7.10_linux_amd64/logs/errors.log<br>ExecStart      = /opt/pocketbase_0.7.10_linux_amd64/pocketbase serve --http="yourdomain.com:80" --https="yourdomain.com:443"</code></pre>
<p>You should now be able to enable and start the pocketbase service by running the following commands:</p>
<pre class="language-markup"><code class="language-markup">systemctl enable pocketbase.service<br>systemctl start pocketbase</code></pre>
<p>This should result in the following:</p>
<pre class="language-markup"><code class="language-markup">root@my-ubuntu:/opt/pocketbase_0.7.10_linux_amd64/logs# service pocketbase status<br>● pocketbase.service - pocketbase<br>     Loaded: loaded (/lib/systemd/system/pocketbase.service; disabled; preset: enabled)<br>     Active: active (running) since Tue 2022-11-08 04:40:57 UTC; 2s ago<br>   Main PID: 1942 (pocketbase)<br>      Tasks: 6 (limit: 511)<br>     Memory: 8.0M<br>        CPU: 31ms<br>     CGroup: /system.slice/pocketbase.service<br>             └─1942 /opt/pocketbase_0.7.10_linux_amd64/pocketbase serve --http=yourdomain.com:80 --https=yourdomain.com:443</code></pre>
<p>If you have done the above, you should be able to to access your PocketBase instance via the following urls:</p>
<pre class="language-markup"><code class="language-markup">https://yourdomain.com/_/ - Admin dashboard UI<br>https://yourdomain.com/api - REST API</code></pre>
<p>Note: if both the --http and --https flags are specified in the serve command defined above, PocketBase will provision an SSL certificate for your website using letsencrypt thus the website will be served from a https address.</p>
<p>Links:</p>
<ul>
<li>[1] <a id="link-1" href="https://docs.digitalocean.com/products/droplets/how-to/create/">How to Create a Droplet from the DigitalOcean Control Panel</a></li>
<li>[2] <a id="link-2" href="https://docs.digitalocean.com/products/droplets/how-to/add-ssh-keys/">How-to Add SSH Keys to New or Existing Droplets</a></li>
<li>[3] <a id="link-3" href="https://docs.digitalocean.com/products/networking/dns/quickstart/">Dns Quickstart</a></li>
<li>[4] <a id="link-4" href="https://pocketbase.io/">PocketBase</a></li>
</ul>

<div class="post-nav">
  <ul><li><strong>Previous:</strong> <a href="/posts/the-power-of-laziness-automating-some-text-entry-work/">The power of laziness - automating some text entry work</a></li><li><strong>Next:</strong> <a href="/posts/the-tailwind-dilemma-utility-first-vs-semantic-css/">The tailwind dilemma - utility first vs semantic CSS</a></li>
  </ul>
</div>

    </main>

    <footer role="contentinfo">
      <div class="container">
        <div class="left">&copy 2022 mirzapandzo.com</div>
        <div class="right">Built with <a href="https://github.com/11ty/eleventy-base-blog">11ty</a>
      </div>
    </footer>

    <!-- Current page: /posts/deploying-pocketbase-to-a-digital-ocean-droplet/ -->
  </body>
</html>
